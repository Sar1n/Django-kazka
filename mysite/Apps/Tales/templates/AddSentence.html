{% extends "wrapper.html" %}

{% block content %}
<div class="jumbotron">

  <div>
      <script>
          function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = cookies[i].trim();
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
          }
        var csrftoken = getCookie('csrftoken');


        function csrfSafeMethod(method) {
            // these HTTP methods do not require CSRF protection
            return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
        }
        $.ajaxSetup({
            beforeSend: function(xhr, settings) {
                if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", csrftoken);
                }
            }
        });
      </script>
  </div> <!--CSRF TOKEN HERE-->
  {% csrf_token %}
  
  <script type="text/javascript">
      var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
  </script>


    <div class="container">
        <h1>Тестовая хтмль для добавления предложения в сказку</h1>
        <h4>Предыдущее предложение:</h4>
        
        <h4>Напишите свое продолжение:</h4>
        <div class="text">
            <textarea name="Sentence" cols="50" rows="3" id='textarea'></textarea>
        </div>
        <a>
            <button id='btn-add' class="btn btn-success btn-lg" >Добавить предложение к сказке</button>
        </a>
        <a>
            <button id='btn-addandclose' class="btn btn-success btn-lg" >Закончить сказку моим предложением</button>
        </a>
    </div>
</div>

<div>
  <script type="text/javascript">
    $('#btn-add').click
    (
        function()
        {
            $.ajax
            (
                {
                    url: "ajax/testadd/",
                    type: "POST",
                    success: function()
                    {
                        alert("good");
                    }
                }
            )
        .fail(function() {
        alert("fail");
        });
        }
    );
  </script>

<script type="text/javascript">
  $('#btn-addandclose').click
  (
      function()
      {
          var textdata = document.getElementById("textarea").value
          $.ajax
          (
              {
                  url: "ajax/textadd/",
                  type: "POST",
                  data: {"textdata": textdata},
                  success: function()
                  {
                      alert("good");
                  }
              }
          )
      .fail(function() {
      alert("fail");
      });
      }
  );
</script>

</div>
{% endblock %}